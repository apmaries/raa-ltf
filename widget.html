<!DOCTYPE html>
<html>
  <head>
    <title>Widget</title>

    <link
      href="https://dhqbrvplips7x.cloudfront.net/common-ui-docs/genesys-webcomponents/3.8.1-178/genesys-webcomponents/genesys-webcomponents.css"
      rel="stylesheet"
    />

    <script
      type="module"
      src="https://dhqbrvplips7x.cloudfront.net/common-ui-docs/genesys-webcomponents/3.8.1-178/genesys-webcomponents/genesys-webcomponents.esm.js"
    ></script>
    <script src="https://sdk-cdn.mypurecloud.com/javascript/latest/purecloud-platform-client-v2.min.js"></script>

    <script type="module" src="script.js"></script>

    <style>
      .dropdown {
        margin-bottom: 20px;
      }
    </style>
  </head>
  <body>
    <fieldset>
      <h1>RAA Long Term Forecast</h1>

      <div class="dropdown">
        <label for="businessUnit">Business Unit:</label>
        <gux-dropdown
          id="businessUnit"
          filter-type="starts-with"
          placeholder="Select a thing"
        >
          <gux-listbox
            id="business-unit-listbox"
            aria-label="Business Unit Selection"
          >
            <gux-option value="a">Ant</gux-option>
            <gux-option value="b">Bat</gux-option>
            <gux-option value="c">Cat</gux-option>
          </gux-listbox>
        </gux-dropdown>
      </div>

      <div class="dropdown">
        <label for="forecast">Forecast:</label>
        <gux-dropdown
          id="forecast"
          filter-type="starts-with"
          placeholder="Select a thing"
        >
          <gux-listbox id="forecast-listbox" aria-label="Forecast Selection">
            <gux-option value="a">Ant</gux-option>
            <gux-option value="b">Bat</gux-option>
            <gux-option value="c">Cat</gux-option>
          </gux-listbox>
        </gux-dropdown>
      </div>

      <gux-button id="generateBtn" accent="primary">Generate</gux-button>
    </fieldset>
    <script>
      // wait for dom to load
      document.addEventListener("DOMContentLoaded", function () {
        var platformClient = window.require("platformClient");

        var clientEnvironment = document.getElementById(
          "clientEnvironmentInput"
        );
        var clientId = document.getElementById("clientIdInput");
        var authenticateButton = document.getElementById("authenticate-button");

        authenticateButton.addEventListener("click", function () {
          var client = platformClient.ApiClient.instance;
          client.setEnvironment(clientEnvironment.value);
          client.setPersistSettings(true, "wpt");

          try {
            client.loginImplicitGrant(
              clientId.value,
              "https://apmaries.github.io/wpt/wpt-home.html"
            );
            sessionStorage.setItem("client_id", clientId.value);
            sessionStorage.setItem("client_env", clientEnvironment.value);
          } catch (e) {
            console.error("WPT: Error logging in", e);
          }
        });
      });
    </script>
  </body>
</html>
